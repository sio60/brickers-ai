# 🛠️ 개발 시행착오 및 해결 리포트 (Daily Trial & Error Log)

오늘 **PyBullet 물리 검증 시스템**을 구축하면서 겪은 주요 문제들과 그 해결 과정을 정리했습니다.

## 1. 💥 물리 엔진 폭발 (Simulation Explosion)
*   **문제**: `stair4.ldr`을 처음 돌렸을 때, 브릭들이 시작하자마자 사방으로 튕겨 나감.
*   **원인**: 레고의 실제 메쉬(Mesh)는 스터드(돌기)와 튜브(구멍)가 겹치게 설계되어 있는데, 물리 엔진은 이를 **"심각한 충돌(Collision)"**로 인식하여 엄청난 반발력을 발생시킴.
*   **해결**: **Box Primitive 도입**.
    *   복잡한 메쉬 대신, 브릭을 단순한 **직육면체(Box)**로 치환하여 물리 계산을 수행.
    *   충돌은 단순화하고, 시각적 요소는 유지함.

## 2. 👻 유령 브릭 현상 (One Block Issue)
*   **문제**: `stair4` (브릭 2개)를 로드했는데, 화면에는 마치 브릭이 **하나밖에 없는 것처럼** 보이고 위치가 겹쳐 있음.
*   **원인**: `createConstraint` (본드) 설정 실수.
    *   `childFramePosition=[0,0,0]`으로 설정하여, **"두 브릭의 중심을 강제로 일치시켜라"**고 명령해버림.
*   **해결**: **상대 좌표(Relative Offset/Pivot) 계산** 로직 추가.
    *   두 브릭의 현재 위치 차이를 계산하여, 그 간격을 유지한 채로 고정하도록 수정.

## 3. 🗿 안 넘어지는 캔틸레버 (Infinite Stability)
*   **문제**: `stair.ldr` (위태로운 계단)이 무너져야 정상인데, 꿈쩍도 안 하고 버팀.
*   **원인**: **Ground Anchor (바닥 고정) 로직**.
    *   초기 설정에서 바닥에 닿은 브릭은 무조건 `mass=0` (고정)으로 설정했었음. 지지대가 본드로 바닥에 붙어 있으니 절대 안 넘어짐.
*   **해결**: **Anchor 제거 & 마찰력(Friction) 증대**.
    *   모든 브릭을 `Dynamic`(움직임 가능)으로 바꾸되, `lateralFriction=0.9`를 주어 쉽게 미끄러지지 않게 함. 이제 무게중심이 쏠리면 넘어짐.

## 4. 🐍 의존성 다이어트 실패 (Dependency Error)
*   **문제**: `run_pipeline.py` 실행 시 `ImportError: No module named 'numpy'` 발생.
*   **원인**: `requirements.txt`를 정리하면서, 안 쓴다고 생각한 필수 라이브러리(`numpy`, `scipy`)까지 지워버림.
*   **해결**: **필수 4대장 복구**.
    *   `numpy`, `scipy`, `networkx`, `pybullet` 다시 추가. 불필요한 `fastapi`, `torch` 등만 제거.

## 5. 📉 자잘한 코드 실수
*   `NameError: get_brick_studs_count`: 함수를 쓰면서 import를 빼먹음.
*   `NameError: pb_x`: 박스 로직 추가하다가 좌표 계산 코드를 실수로 지움.
*   **교훈**: 코드를 수정할 때, **기존 변수(dependency)가 유지되는지** 더 꼼꼼히 확인해야 함.

---
**총평**:
물리 엔진은 **"거짓말을 하지 않지만, 융통성도 없다"**는 것을 다시 확인했습니다. 
사람의 눈대중(대충 겹치면 붙은 거지)이 통하지 않으므로, **정확한 수학적 계산(Pivot, AABB)**과 **물리 법칙(Gravity, Mass)**을 코드로 엄격하게 정의해야만 제대로 동작했습니다. 
결과적으로, 초기의 불안정한 시뮬레이션이 현재는 **매우 정확하고 신뢰할 수 있는 검증 도구**로 변모했습니다.
